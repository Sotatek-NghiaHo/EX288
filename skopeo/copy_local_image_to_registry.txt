#skopeo copy containers-storate:/<image:tag> docker://quay.io/<username>/<image:tag>

skopeo copy containers-storage:localhost/ubi-sleep:latest docker://quay.io/valentinouberti/ubi-sleep:1.0

---


ğŸ§© CÃº phÃ¡p tá»•ng quÃ¡t
```
skopeo copy <SOURCE> <DESTINATION>
```

â†’ DÃ¹ng Ä‘á»ƒ copy image tá»« nguá»“n (source) sang Ä‘Ã­ch (destination).

ğŸ”¹ Giáº£i thÃ­ch tá»«ng pháº§n trong vÃ­ dá»¥ cá»§a báº¡n
skopeo copy containers-storage:localhost/ubi-sleep:latest docker://quay.io/valentinouberti/ubi-sleep:1.0

1ï¸âƒ£ containers-storage:localhost/ubi-sleep:latest

ÄÃ¢y lÃ  nguá»“n (source).

containers-storage: nghÄ©a lÃ  image náº±m trong local container storage (vÃ­ dá»¥ nhÆ° Podman hoáº·c Buildah Ä‘ang dÃ¹ng).

Tá»©c lÃ  image nÃ y Ä‘Ã£ Ä‘Æ°á»£c build hoáº·c pull vá» local trÆ°á»›c Ä‘Ã³, vÃ­ dá»¥ báº±ng podman build hay podman pull.

localhost/ubi-sleep:latest lÃ  tÃªn vÃ  tag cá»§a image local.
â†’ VÃ­ dá»¥ image ubi-sleep:latest Ä‘ang cÃ³ sáºµn trÃªn mÃ¡y báº¡n.

2ï¸âƒ£ docker://quay.io/valentinouberti/ubi-sleep:1.0

ÄÃ¢y lÃ  Ä‘Ã­ch (destination).

docker:// nghÄ©a lÃ  Ä‘áº©y (push) Ä‘áº¿n má»™t Docker registry (giá»‘ng nhÆ° Docker Hub, Quay.io, Harbor, v.v.).

quay.io/valentinouberti/ubi-sleep:1.0 lÃ  repository vÃ  tag má»›i sáº½ xuáº¥t hiá»‡n trÃªn Quay.io.

â†’ Tá»©c lÃ  báº¡n Ä‘ang Ä‘áº©y image tá»« local storage lÃªn remote registry Quay.io.

ğŸ’¡ TÃ³m táº¯t dá»… hiá»ƒu

| ThÃ nh pháº§n                              | Ã nghÄ©a                                   |
| --------------------------------------- | ----------------------------------------- |
| `skopeo copy`                           | Sao chÃ©p image giá»¯a cÃ¡c nguá»“n khÃ¡c nhau   |
| `containers-storage:`                   | Nguá»“n lÃ  local storage cá»§a Podman/Buildah |
| `docker://`                             | ÄÃ­ch lÃ  Docker registry                   |
| `ubi-sleep:latest`                      | TÃªn vÃ  tag cá»§a image local                |
| `quay.io/valentinouberti/ubi-sleep:1.0` | Repository vÃ  tag má»›i trÃªn Quay.io        |

âœ… Káº¿t quáº£ cá»§a lá»‡nh nÃ y

Sau khi cháº¡y xong:

Image ubi-sleep:latest trÃªn local sáº½ Ä‘Æ°á»£c upload lÃªn Quay.io.

TrÃªn Quay.io, báº¡n sáº½ tháº¥y má»™t image má»›i tÃªn:

quay.io/valentinouberti/ubi-sleep:1.0

ğŸ” LÆ°u Ã½ vá» authentication

TrÆ°á»›c khi push, báº¡n cáº§n Ä‘Äƒng nháº­p vÃ o Quay.io:
```
podman login quay.io
```

hoáº·c
```
skopeo login quay.io
```

â†’ Náº¿u khÃ´ng, báº¡n sáº½ bá»‹ lá»—i unauthorized: access to the requested resource is not authorized.

ğŸ§  Máº¹o thÃªm

skopeo cá»±c ká»³ máº¡nh vÃ¬ nÃ³ cÃ³ thá»ƒ copy image giá»¯a nhiá»u â€œschemeâ€ khÃ¡c nhau:

| Scheme                | Ã nghÄ©a                                                 |
| --------------------- | ------------------------------------------------------- |
| `docker://`           | Docker/OCI registry (Docker Hub, Quay.io, Harbor, etc.) |
| `containers-storage:` | Local Podman/Buildah storage                            |
| `dir:`                | Copy vÃ o thÆ° má»¥c local                                  |
| `oci:`                | Copy vÃ o Ä‘á»‹nh dáº¡ng OCI (Open Container Initiative)      |
| `docker-archive:`     | Copy tá»« file `.tar` do `docker save` táº¡o ra             |

VÃ­ dá»¥:
```
# Copy tá»« Docker Hub sang Quay.io mÃ  khÃ´ng cáº§n pull
skopeo copy docker://docker.io/library/nginx:latest docker://quay.io/myuser/nginx:latest
```

â†’ KhÃ´ng cáº§n load hay run container â€” skopeo xá»­ lÃ½ trá»±c tiáº¿p giá»¯a 2 registry!

ğŸ‘‰ TÃ³m láº¡i, lá»‡nh cá»§a báº¡n:
```
skopeo copy containers-storage:localhost/ubi-sleep:latest docker://quay.io/valentinouberti/ubi-sleep:1.0
```

> nghÄ©a lÃ :

"Äáº©y image ubi-sleep:latest tá»« local storage cá»§a Podman lÃªn registry Quay.io (user valentinouberti), tag láº¡i lÃ  1.0."

---

ğŸ§© 1ï¸âƒ£ Náº¿u báº¡n Ä‘Ã£ podman login, thÃ¬:

Báº¡n hoÃ n toÃ n cÃ³ thá»ƒ:
```
podman tag localhost/ubi-sleep:latest quay.io/valentinouberti/ubi-sleep:1.0
podman push quay.io/valentinouberti/ubi-sleep:1.0
```
ğŸ‘‰ Äiá»u gÃ¬ xáº£y ra:

podman tag chá»‰ táº¡o thÃªm má»™t â€œnhÃ£nâ€ (alias) trá» Ä‘áº¿n cÃ¹ng image ID trong local storage.
â†’ KhÃ´ng táº¡o báº£n copy, chá»‰ thÃªm má»™t tag má»›i.

podman push sáº½ Ä‘áº©y image Ä‘Ã³ lÃªn registry (á»Ÿ Ä‘Ã¢y lÃ  Quay.io), giá»‘ng há»‡t vá»›i nhá»¯ng gÃ¬ skopeo copy lÃ m.

âœ… Káº¿t quáº£: Image Ä‘Æ°á»£c upload lÃªn Quay.io vá»›i tag 1.0.

ğŸ” 2ï¸âƒ£ Váº­y khÃ¡c gÃ¬ vá»›i skopeo copy?

| TÃ­nh nÄƒng                                       | `podman push`                            | `skopeo copy`                                            |
| ----------------------------------------------- | ---------------------------------------- | -------------------------------------------------------- |
| **YÃªu cáº§u local image**                         | âœ… CÃ³ (pháº£i tá»“n táº¡i trong Podman storage) | âš™ï¸ KhÃ´ng cáº§n (cÃ³ thá»ƒ copy giá»¯a 2 remote registry luÃ´n)   |
| **Cáº§n login trÆ°á»›c**                             | âœ… `podman login`                         | âœ… `skopeo login` hoáº·c `podman login`                     |
| **Copy giá»¯a registry â†’ registry**               | âŒ KhÃ´ng (chá»‰ push tá»« local)              | âœ… CÃ³ thá»ƒ (vÃ­ dá»¥ Docker Hub â†’ Quay.io)                    |
| **Copy giá»¯a nhiá»u storage backend**             | âŒ Giá»›i háº¡n (chá»‰ Podman â†’ registry)       | âœ… Ráº¥t linh hoáº¡t (`docker://`, `dir:`, `oci:`, `tar:`...) |
| **CÃ³ thá»ƒ cháº¡y trong CI/CD mÃ  khÃ´ng cáº§n daemon** | ğŸš« KhÃ´ng                                 | âœ… CÃ³ (khÃ´ng cáº§n Podman/Docker daemon cháº¡y)               |

âš¡ VÃ­ dá»¥ so sÃ¡nh
ğŸ”¹ CÃ¡ch 1 â€“ DÃ¹ng Podman
```
podman login quay.io
podman tag ubi-sleep:latest quay.io/valentinouberti/ubi-sleep:1.0
podman push quay.io/valentinouberti/ubi-sleep:1.0
```
ğŸ”¹ CÃ¡ch 2 â€“ DÃ¹ng Skopeo
```
skopeo login quay.io
skopeo copy containers-storage:localhost/ubi-sleep:latest docker://quay.io/valentinouberti/ubi-sleep:1.0
```

ğŸ“¦ Káº¿t quáº£ cuá»‘i cÃ¹ng y há»‡t nhau: image ubi-sleep:1.0 xuáº¥t hiá»‡n trÃªn Quay.io.
Chá»‰ khÃ¡c á»Ÿ cÃ´ng cá»¥ vÃ  cÃ¡ch tiáº¿p cáº­n.

ğŸ§  Káº¿t luáº­n dá»… nhá»›

| TrÆ°á»ng há»£p                                                                  | DÃ¹ng cÃ¡i nÃ o                 |
| --------------------------------------------------------------------------- | ---------------------------- |
| Báº¡n Ä‘ang lÃ m viá»‡c local, Ä‘Ã£ build image báº±ng Podman â†’ push lÃªn registry     | ğŸŸ¢ **Podman (`tag + push`)** |
| Báº¡n cáº§n copy image giá»¯a 2 registry, hoáº·c trong CI/CD khÃ´ng cÃ³ Podman daemon | ğŸŸ¢ **Skopeo (`copy`)**       |
| Báº¡n muá»‘n automation, kiá»ƒm tra, hoáº·c copy Ä‘á»‹nh dáº¡ng OCI/tar                  | ğŸŸ¢ **Skopeo**                |


ğŸ‘‰ TÃ³m láº¡i:

Náº¿u báº¡n chá»‰ cáº§n push image local lÃªn Quay.io vÃ  Ä‘Ã£ podman login, thÃ¬ podman tag + push hoÃ n toÃ n Ä‘á»§ â€” nhanh, gá»n, vÃ  giá»‘ng skopeo copy.

NhÆ°ng náº¿u báº¡n muá»‘n copy giá»¯a nhiá»u nguá»“n khÃ¡c nhau (registry â†” tar â†” local), hoáº·c cháº¡y script trong CI/CD, thÃ¬ skopeo máº¡nh hÆ¡n nhiá»u.

---

ğŸ§© TÃ¬nh huá»‘ng giáº£ Ä‘á»‹nh

Giáº£ sá»­ báº¡n cÃ³:

Má»™t image trÃªn Docker Hub:
ğŸ³ docker.io/library/nginx:latest

Báº¡n muá»‘n copy image Ä‘Ã³ sang Quay.io cá»§a báº¡n:
ğŸ“¦ quay.io/valentinouberti/nginx:latest

ğŸš€ CÃ¡ch lÃ m vá»›i skopeo (khÃ´ng cáº§n pull vá» local)
```
skopeo copy docker://docker.io/library/nginx:latest docker://quay.io/valentinouberti/nginx:latest
```
ğŸ” Giáº£i thÃ­ch:
| ThÃ nh pháº§n                                          | Ã nghÄ©a                                                        |
| --------------------------------------------------- | -------------------------------------------------------------- |
| `skopeo copy`                                       | Sao chÃ©p image                                                 |
| `docker://docker.io/library/nginx:latest`           | Nguá»“n lÃ  image tá»« Docker Hub                                   |
| `docker://quay.io/valentinouberti/nginx:latest`     | ÄÃ­ch lÃ  image trÃªn Quay.io                                     |
| ğŸ‘‰ KhÃ´ng cáº§n `podman pull` hoáº·c `docker pull` trÆ°á»›c | `skopeo` xá»­ lÃ½ stream trá»±c tiáº¿p giá»¯a hai registry qua HTTP API |


| Registry                        | Cáº§n Ä‘Äƒng nháº­p khÃ´ng?             | LÃ½ do                                                                     |
| ------------------------------- | -------------------------------- | ------------------------------------------------------------------------- |
| ğŸ³ **Docker Hub** (`docker.io`) | âŒ KhÃ´ng cáº§n náº¿u image **public** | VÃ­ dá»¥ `library/nginx` lÃ  public, ai cÅ©ng pull Ä‘Æ°á»£c                        |
| ğŸ“¦ **Quay.io**                  | âœ… Báº®T BUá»˜C cáº§n login             | VÃ¬ báº¡n Ä‘ang **push** (ghi lÃªn repo cá»§a báº¡n), cáº§n quyá»n ghi (write access) |


